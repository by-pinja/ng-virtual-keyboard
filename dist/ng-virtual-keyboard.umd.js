!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@angular/core"),require("@angular/material"),require("rxjs/internal/ReplaySubject"),require("@angular/common"),require("@angular/forms"),require("@angular/flex-layout")):"function"==typeof define&&define.amd?define(["@angular/core","@angular/material","rxjs/internal/ReplaySubject","@angular/common","@angular/forms","@angular/flex-layout"],t):"object"==typeof exports?exports["ng-virtual-keyboard"]=t(require("@angular/core"),require("@angular/material"),require("rxjs/internal/ReplaySubject"),require("@angular/common"),require("@angular/forms"),require("@angular/flex-layout")):e["ng-virtual-keyboard"]=t(e["@angular/core"],e["@angular/material"],e["rxjs/internal/ReplaySubject"],e["@angular/common"],e["@angular/forms"],e["@angular/flex-layout"])}(window,(function(e,t,n,i,o,a){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){"use strict";function i(e){return e.length>1&&!!t.specialKeys.filter((function(t){return new RegExp("^("+t+")(:(\\d+(\\.\\d+)?))?$","g").test(e)})).length}Object.defineProperty(t,"__esModule",{value:!0}),t.alphanumericKeyboard=[["1","2","3","4","5","6","7","8","9","0","Backspace:2"],["q","w","e","r","t","y","u","i","o","p","CapsLock:2"],["a","s","d","f","g","h","j","k","l","Spacer","Shift:2"],["z","x","c","v","b","n","m","Spacer:5"]],t.alphanumericNordicKeyboard=[["1","2","3","4","5","6","7","8","9","0","Spacer","Backspace:2"],["q","w","e","r","t","y","u","i","o","p","å","CapsLock:2"],["a","s","d","f","g","h","j","k","l","ö","ä","Shift:2"],["z","x","c","v","b","n","m","Spacer:6"]],t.extendedKeyboard=[["1","2","3","4","5","6","7","8","9","0","Backspace:2"],["q","w","e","r","t","y","u","i","o","p","CapsLock:2"],["a","s","d","f","g","h","j","k","l","Spacer","Shift:2"],["z","x","c","v","b","n","m",",",".","-","_","+"],["Spacer","@","SpaceBar:7","#","Spacer:2"]],t.extendedNordicKeyboard=[["1","2","3","4","5","6","7","8","9","0","+","Backspace:2"],["q","w","e","r","t","y","u","i","o","p","å","CapsLock:2"],["a","s","d","f","g","h","j","k","l","ö","ä","Shift:2"],["z","x","c","v","b","n","m",",",".","-","_","Spacer:2"],["Spacer","@","SpaceBar:7","#","Spacer:3"]],t.numericKeyboard=[["1","2","3","Backspace:2"],["4","5","6","Spacer:2"],["7","8","9","Spacer:2"],["Spacer","0","Spacer:3"]],t.phoneKeyboard=[["1","2","3","Backspace:2"],["4","5","6","Spacer:2"],["7","8","9","Spacer:2"],["-","0","+","Spacer:2"]],t.specialKeys=["Enter","Backspace","Escape","CapsLock","SpaceBar","Spacer","Shift"],t.specialKeyIcons={Enter:"keyboard_return",Backspace:"backspace",Escape:"close",SpaceBar:"space_bar",Shift:"keyboard_capslock"},t.specialKeyTexts={CapsLock:"Caps"},t.notDisabledSpecialKeys=["Enter","Backspace","Escape"],t.isSpacer=function(e){return e.length>1&&/^Spacer(:(\d+(\.\d+)?))?$/g.test(e)},t.isSpecial=i,t.keyboardCapsLockLayout=function(e,t){return e.map((function(e){return e.map((function(e){return i(e)?e:t?e.toUpperCase():e.toLowerCase()}))}))}},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),r=n(1),s=n(4),c=n(2),l=function(){function e(e,t){this.element=e,this.dialog=t,this.opened=!1,this.focus=!0,this.keyboardClose=new a.EventEmitter}return e.prototype.onWindowBlur=function(){this.focus=!1},e.prototype.onWindowFocus=function(){var e=this;setTimeout((function(){e.focus=!0}),0)},e.prototype.onFocus=function(){this.openKeyboard()},e.prototype.onClick=function(){this.openKeyboard()},e.prototype.openKeyboard=function(){var e=this;if(!this.opened&&this.focus){this.opened=!0;var t=void 0;(t=this.dialog.open(s.VirtualKeyboardComponent)).componentInstance.inputElement=this.element,t.componentInstance.layout=this.getLayout(),t.componentInstance.placeholder=this.getPlaceHolder(),t.componentInstance.type=this.getType(),t.afterClosed().subscribe((function(){e.keyboardClose.emit(),setTimeout((function(){e.opened=!1}),0)}))}},e.prototype.getLayout=function(){var e;switch(this.layout){case"alphanumeric":e=c.alphanumericKeyboard;break;case"alphanumericNordic":e=c.alphanumericNordicKeyboard;break;case"extended":e=c.extendedKeyboard;break;case"extendedNordic":e=c.extendedNordicKeyboard;break;case"numeric":e=c.numericKeyboard;break;case"phone":e=c.phoneKeyboard;break;default:e=this.layout}return e},e.prototype.getPlaceHolder=function(){return this.placeholder?this.placeholder:this.element.nativeElement.placeholder},e.prototype.getType=function(){return this.type?this.type:this.element.nativeElement.type},i([a.Input("ng-virtual-keyboard-layout"),o("design:type",Object)],e.prototype,"layout",void 0),i([a.Input("ng-virtual-keyboard-placeholder"),o("design:type",String)],e.prototype,"placeholder",void 0),i([a.Input("ng-virtual-keyboard-type"),o("design:type",String)],e.prototype,"type",void 0),i([a.Output("ng-virtual-keyboard-close"),o("design:type",a.EventEmitter)],e.prototype,"keyboardClose",void 0),i([a.HostListener("window:blur"),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],e.prototype,"onWindowBlur",null),i([a.HostListener("window:focus"),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],e.prototype,"onWindowFocus",null),i([a.HostListener("focus"),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],e.prototype,"onFocus",null),i([a.HostListener("click"),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],e.prototype,"onClick",null),e=i([a.Directive({selector:"[ng-virtual-keyboard]"}),o("design:paramtypes",[a.ElementRef,r.MatDialog])],e)}();t.NgVirtualKeyboardDirective=l},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),r=n(1),s=n(2),c=n(5),l=function(){function e(e,t){this.dialogRef=e,this.virtualKeyboardService=t,this.shift=!1}var t;return t=e,e.setSelectionRange=function(e,t,n){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,n);else if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",t),i.select()}},e.prototype.ngOnInit=function(){var e=this;setTimeout((function(){e.keyboardInput.nativeElement.focus()}),0),this.virtualKeyboardService.shift$.subscribe((function(t){e.shift=t})),this.virtualKeyboardService.capsLock$.subscribe((function(t){e.layout=s.keyboardCapsLockLayout(e.layout,t)})),this.virtualKeyboardService.caretPosition$.subscribe((function(n){e.caretPosition=n,setTimeout((function(){t.setSelectionRange(e.keyboardInput.nativeElement,n,n)}),0)})),this.inputElement.nativeElement.value.length&&this.virtualKeyboardService.setCaretPosition(this.inputElement.nativeElement.value.length),this.maxLength=this.inputElement.nativeElement.maxLength>0?this.inputElement.nativeElement.maxLength:"",this.checkDisabled()},e.prototype.ngOnDestroy=function(){this.virtualKeyboardService.reset()},e.prototype.close=function(){this.dialogRef.close()},e.prototype.updateCaretPosition=function(){this.virtualKeyboardService.setCaretPosition(this.keyboardInput.nativeElement.selectionStart)},e.prototype.keyPress=function(e){e.special?this.handleSpecialKey(e):(this.handleNormalKey(e.keyValue),this.dispatchEvents(e),this.shift&&this.virtualKeyboardService.toggleShift()),this.checkDisabled()},e.prototype.checkDisabled=function(){var e=this.inputElement.nativeElement.maxLength,t=this.inputElement.nativeElement.value.length;this.disabled=e>0&&t>=e},e.prototype.handleNormalKey=function(e){var t="";isNaN(this.caretPosition)?t=""+this.inputElement.nativeElement.value+e:(t=[this.inputElement.nativeElement.value.slice(0,this.caretPosition),e,this.inputElement.nativeElement.value.slice(this.caretPosition)].join(""),this.virtualKeyboardService.setCaretPosition(this.caretPosition+1)),this.inputElement.nativeElement.value=t},e.prototype.handleSpecialKey=function(e){switch(e.keyValue){case"Enter":case"Escape":this.close();break;case"Backspace":var t=this.inputElement.nativeElement.value;if(isNaN(this.caretPosition))this.inputElement.nativeElement.value=t.substring(0,t.length-1);else if(this.caretPosition>0){var n=t.slice(0,this.caretPosition-1),i=t.slice(this.caretPosition);this.inputElement.nativeElement.value=""+n+i,this.virtualKeyboardService.setCaretPosition(this.caretPosition-1)}this.dispatchEvents(e),this.keyboardInput.nativeElement.focus();break;case"CapsLock":this.virtualKeyboardService.toggleCapsLock();break;case"Shift":this.virtualKeyboardService.toggleShift();break;case"SpaceBar":this.handleNormalKey(" ")}},e.prototype.dispatchEvents=function(e){var t={bubbles:!0,cancelable:!0,shiftKey:this.shift,key:e.keyValue,code:"Key"+e.keyValue.toUpperCase()+"}",location:0};this.inputElement.nativeElement.dispatchEvent(new KeyboardEvent("keydown",t)),this.inputElement.nativeElement.dispatchEvent(new KeyboardEvent("keypress",t)),this.inputElement.nativeElement.dispatchEvent(new Event("input",{bubbles:!0})),this.inputElement.nativeElement.dispatchEvent(new KeyboardEvent("keyup",t)),this.keyboardInput.nativeElement.focus()},i([a.ViewChild("keyboardInput",{static:!0}),o("design:type",a.ElementRef)],e.prototype,"keyboardInput",void 0),e=t=i([a.Component({selector:"virtual-keyboard",template:'\n    <div class="container">\n      <div fxLayout="column">\n        <mat-form-field>\n          <button class="close" color="primary" mat-button mat-mini-fab\n            (click)="close()"\n          >\n            <mat-icon>check</mat-icon>\n          </button>\n    \n          <input type="{{type}}"\n            matInput\n            #keyboardInput\n            (click)="updateCaretPosition()"\n            [(ngModel)]="inputElement.nativeElement.value" placeholder="{{ placeholder }}"\n            [maxLength]="maxLength"\n          />\n        </mat-form-field>\n    \n        <div fxLayout="row" fxLayoutAlign="center center"\n          *ngFor="let row of layout; let rowIndex = index"\n          [attr.data-index]="rowIndex"\n        >\n          <virtual-keyboard-key\n            *ngFor="let key of row; let keyIndex = index"\n            [key]="key"\n            [disabled]="disabled"\n            [attr.data-index]="keyIndex"\n            (keyPress)="keyPress($event)"\n          ></virtual-keyboard-key>\n        </div>\n      </div>\n    </div>\n  ',styles:["\n    .close {\n      position: relative;\n      float: right;\n      top: -16px;\n      right: 0;\n      margin-bottom: -40px;\n    }\n  \n    .mat-input-container {\n      margin: -16px 0;\n      font-size: 32px;\n    }\n  \n    .mat-input-element:disabled {\n      color: currentColor;\n    }\n\n    :host /deep/ .mat-input-placeholder {\n      top: 10px !important;\n      font-size: 24px !important;\n    }\n  "]}),o("design:paramtypes",[r.MatDialogRef,c.VirtualKeyboardService])],e)}();t.VirtualKeyboardComponent=l},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(7),r=function(){function e(){this.shift$=new a.ReplaySubject(1),this.capsLock$=new a.ReplaySubject(1),this.caretPosition$=new a.ReplaySubject(1),this.capsLock=!1,this.shift=!1}return e.prototype.setShift=function(e){this.shift=e,this.shift$.next(this.shift),this.setCapsLock(this.shift)},e.prototype.setCapsLock=function(e){this.capsLock=e,this.capsLock$.next(e)},e.prototype.toggleShift=function(){this.shift=!this.shift,this.shift$.next(this.shift),this.setCapsLock(this.shift)},e.prototype.toggleCapsLock=function(){this.capsLock=!this.capsLock,this.capsLock$.next(this.capsLock)},e.prototype.setCaretPosition=function(e){this.caretPosition$.next(e)},e.prototype.reset=function(){this.setShift(!1)},e=i([o.Injectable()],e)}();t.VirtualKeyboardService=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3);t.NgVirtualKeyboardDirective=i.NgVirtualKeyboardDirective;var o=n(8);t.NgVirtualKeyboardModule=o.NgVirtualKeyboardModule},function(e,t){e.exports=n},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(9),r=n(10),s=n(1),c=n(11),l=n(3),p=n(4),u=n(12),d=n(5),y=function(){function e(){}return e=i([o.NgModule({declarations:[l.NgVirtualKeyboardDirective,p.VirtualKeyboardComponent,u.VirtualKeyboardKeyComponent],providers:[d.VirtualKeyboardService],imports:[a.CommonModule,r.FormsModule,r.ReactiveFormsModule,c.FlexLayoutModule,s.MatButtonModule,s.MatDialogModule,s.MatIconModule,s.MatInputModule],entryComponents:[p.VirtualKeyboardComponent],exports:[l.NgVirtualKeyboardDirective]})],e)}();t.NgVirtualKeyboardModule=y},function(e,t){e.exports=i},function(e,t){e.exports=o},function(e,t){e.exports=a},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),r=n(2),s=function(){function e(){this.keyPress=new a.EventEmitter,this.special=!1,this.spacer=!1}return e.prototype.ngOnInit=function(){var e=1,t=0;if(this.key.length>1){this.spacer=r.isSpacer(this.key),this.special=r.isSpecial(this.key);var n=/^(\w+)(:(\d+(\.\d+)?))?$/g.exec(this.key);this.keyValue=n[1],n[3]&&(t=4*((e=parseFloat(n[3]))-1))}else this.keyValue=this.key;this.special&&(r.specialKeyIcons.hasOwnProperty(this.keyValue)?this.icon=r.specialKeyIcons[this.keyValue]:r.specialKeyTexts.hasOwnProperty(this.keyValue)&&(this.text=r.specialKeyTexts[this.keyValue])),this.flexValue=64*e+t+"px"},e.prototype.isDisabled=function(){return!!this.spacer||(!this.disabled||-1===r.notDisabledSpecialKeys.indexOf(this.keyValue))&&this.disabled},e.prototype.onKeyPress=function(){this.keyPress.emit({special:this.special,keyValue:this.keyValue,key:this.key})},i([a.Input(),o("design:type",String)],e.prototype,"key",void 0),i([a.Input(),o("design:type",Boolean)],e.prototype,"disabled",void 0),i([a.Output(),o("design:type",Object)],e.prototype,"keyPress",void 0),e=i([a.Component({selector:"virtual-keyboard-key",template:'\n    <button\n      mat-raised-button\n      color="primary"\n      fxFlex="{{ flexValue }}"\n      [class.spacer]="spacer"\n      [disabled]="isDisabled()"\n      (click)="onKeyPress()"\n    >\n      <span *ngIf="!special">{{ keyValue }}</span>\n    \n      <span *ngIf="special">\n        <mat-icon *ngIf="icon">{{ icon }}</mat-icon>\n    \n        {{ text }}\n      </span>\n    </button>\n  ',styles:["\n    .mat-button,\n    .mat-icon-button,\n    .mat-raised-button {\n      min-width: 64px;\n      min-height: 64px;\n      padding: 0;\n      margin: 2px;\n      font-size: 32px;\n      line-height: 32px;\n    }\n    \n    .mat-button.spacer,\n    .mat-icon-button.spacer,\n    .mat-raised-button.spacer {\n      background-color: transparent;\n    }\n  "]}),o("design:paramtypes",[])],e)}();t.VirtualKeyboardKeyComponent=s}])}));
//# sourceMappingURL=ng-virtual-keyboard.umd.js.map